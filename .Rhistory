scale_fill_manual(values = c("Autumn" = "goldenrod1", "Winter" = "skyblue", "Spring"="palegreen2", Summer="rosybrown1")) +
ggnewscale::new_scale_fill() +
geom_point(data=bin_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(BS_MR_BLUP_cat), colour=BS_MR_BLUP_cat, fill=BS_MR_BLUP_cat), alpha=0.2) +
geom_line(data=bin_rm_snapped, aes(x=Date, y=`Height (m)`, group=UID, colour=BS_MR_BLUP_cat), stat="smooth", method='lm', linewidth=0.5, se=F, alpha=0.1) +
stat_smooth(data=bin_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(BS_MR_BLUP_cat), colour=BS_MR_BLUP_cat, fill=BS_MR_BLUP_cat), method='lm', linewidth=0.5, se=T, alpha=0.1) +
scale_colour_manual(values = setNames(colors, score_levels), drop = FALSE) +
scale_fill_manual(values = setNames(colors, score_levels)) +
labs(colour="Myrtle rust category", x="Date", title = "Height by myrtle rust binary category across time") +
guides(fill='none') +
geom_vline(data=planting_dates, aes(xintercept=Date), colour='grey70', linetype="dashed", linewidth=0.5) +
facet_wrap(~Site)
plot_both <- plot_dates_height_worst/plot_dates_height_impact/plot_dates_height_binary + plot_layout(guides = "collect", axes = "collect")
ggsave(plot_both, file="~/Uni/Doctorate/Ch Planting/Publication/Plots/plot_dates_height.jpg", width=4000, height=3000, units="px", limitsize=F)
plot_dates_height_worst
score_levels
colors
ggplot() +
geom_rect(data = season_rects, aes(xmin = as.numeric(season_start), xmax = as.numeric(season_end),  ymin = -Inf, ymax = Inf,  fill = Season), alpha = 0.1, inherit.aes = FALSE) +
scale_fill_manual(values = c("Autumn" = "goldenrod1", "Winter" = "skyblue", "Spring"="palegreen2", Summer="rosybrown1")) +
ggnewscale::new_scale_fill() +
geom_point(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Worst_MR_BLUP_cat), colour=Worst_MR_BLUP_cat, fill=Worst_MR_BLUP_cat), alpha=0.2) +
geom_line(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=UID, colour=Worst_MR_BLUP_cat), stat="smooth", method='lm', linewidth=0.5, se=F, alpha=0.1) +
stat_smooth(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Worst_MR_BLUP_cat), colour=Worst_MR_BLUP_cat, fill=Worst_MR_BLUP_cat), method='lm', linewidth=0.5, se=T, alpha=0.1)
ggplot() +
geom_rect(data = season_rects, aes(xmin = as.numeric(season_start), xmax = as.numeric(season_end),  ymin = -Inf, ymax = Inf,  fill = Season), alpha = 0.1, inherit.aes = FALSE) +
scale_fill_manual(values = c("Autumn" = "goldenrod1", "Winter" = "skyblue", "Spring"="palegreen2", Summer="rosybrown1")) +
ggnewscale::new_scale_fill() +
geom_point(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Worst_MR_BLUP_cat), colour=Worst_MR_BLUP_cat, fill=Worst_MR_BLUP_cat), alpha=0.2) +
geom_line(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=UID, colour=Worst_MR_BLUP_cat), stat="smooth", method='lm', linewidth=0.5, se=F, alpha=0.1) +
stat_smooth(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Worst_MR_BLUP_cat), colour=Worst_MR_BLUP_cat, fill=Worst_MR_BLUP_cat), method='lm', linewidth=0.5, se=T, alpha=0.1) +
scale_colour_manual(values = setNames(colors, score_levels), drop = FALSE) +
scale_fill_manual(values = setNames(colors, score_levels), drop = FALSE)
plot_dates_height_worst <- ggplot() +
geom_rect(data = season_rects, aes(xmin = as.numeric(season_start), xmax = as.numeric(season_end),  ymin = -Inf, ymax = Inf,  fill = Season), alpha = 0.1, inherit.aes = FALSE) +
scale_fill_manual(values = c("Autumn" = "goldenrod1", "Winter" = "skyblue", "Spring"="palegreen2", Summer="rosybrown1")) +
ggnewscale::new_scale_fill() +
geom_point(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Worst_MR_BLUP_cat), colour=Worst_MR_BLUP_cat, fill=Worst_MR_BLUP_cat), alpha=0.2) +
geom_line(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=UID, colour=Worst_MR_BLUP_cat), stat="smooth", method='lm', linewidth=0.5, se=F, alpha=0.1) +
stat_smooth(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Worst_MR_BLUP_cat), colour=Worst_MR_BLUP_cat, fill=Worst_MR_BLUP_cat), method='lm', linewidth=0.5, se=T, alpha=0.1) +
scale_colour_manual(values = setNames(colors, score_levels),limits = score_levels, drop = FALSE) +
scale_fill_manual(values = setNames(colors, score_levels), limits = score_levels,drop = FALSE) +
labs(colour="Myrtle rust category", x="Date", title = "Height by myrtle rust worst category across time")
ggplot() +
geom_rect(data = season_rects, aes(xmin = as.numeric(season_start), xmax = as.numeric(season_end),  ymin = -Inf, ymax = Inf,  fill = Season), alpha = 0.1, inherit.aes = FALSE) +
scale_fill_manual(values = c("Autumn" = "goldenrod1", "Winter" = "skyblue", "Spring"="palegreen2", Summer="rosybrown1")) +
ggnewscale::new_scale_fill() +
geom_point(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Worst_MR_BLUP_cat), colour=Worst_MR_BLUP_cat, fill=Worst_MR_BLUP_cat), alpha=0.2) +
geom_line(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=UID, colour=Worst_MR_BLUP_cat), stat="smooth", method='lm', linewidth=0.5, se=F, alpha=0.1) +
stat_smooth(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Worst_MR_BLUP_cat), colour=Worst_MR_BLUP_cat, fill=Worst_MR_BLUP_cat), method='lm', linewidth=0.5, se=T, alpha=0.1) +
scale_colour_manual(values = setNames(colors, score_levels),limits = score_levels, drop = FALSE) +
scale_fill_manual(values = setNames(colors, score_levels), limits = score_levels,drop = FALSE)
## Regular monitoring
score_levels <- c("No infection", "Low", "Mid", "High")
colors <- colorRampPalette(c( "forestgreen", "red"))(length(score_levels))
plot_dates_height_worst <- ggplot() +
geom_rect(data = season_rects, aes(xmin = as.numeric(season_start), xmax = as.numeric(season_end),  ymin = -Inf, ymax = Inf,  fill = Season), alpha = 0.1, inherit.aes = FALSE) +
scale_fill_manual(values = c("Autumn" = "goldenrod1", "Winter" = "skyblue", "Spring"="palegreen2", Summer="rosybrown1")) +
ggnewscale::new_scale_fill() +
geom_point(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Worst_MR_BLUP_cat), colour=Worst_MR_BLUP_cat, fill=Worst_MR_BLUP_cat), alpha=0.2) +
geom_line(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=UID, colour=Worst_MR_BLUP_cat), stat="smooth", method='lm', linewidth=0.5, se=F, alpha=0.1) +
stat_smooth(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Worst_MR_BLUP_cat), colour=Worst_MR_BLUP_cat, fill=Worst_MR_BLUP_cat), method='lm', linewidth=0.5, se=T, alpha=0.1) +
scale_colour_manual(values = setNames(colors, score_levels),limits = score_levels, drop = FALSE) +
scale_fill_manual(values = setNames(colors, score_levels), limits = score_levels,drop = FALSE) +
labs(colour="Myrtle rust category", x="Date", title = "Height by myrtle rust worst category across time") +
guides(fill='none') +
geom_vline(data=planting_dates, aes(xintercept=Date), colour='grey70', linetype="dashed", linewidth=0.5) +
facet_wrap(~Site)
plot_dates_height_worst
plot_dates_height_worst <- ggplot() +
geom_rect(data = season_rects, aes(xmin = as.numeric(season_start), xmax = as.numeric(season_end),  ymin = -Inf, ymax = Inf,  fill = Season), alpha = 0.1, inherit.aes = FALSE) +
scale_fill_manual(values = c("Autumn" = "goldenrod1", "Winter" = "skyblue", "Spring"="palegreen2", Summer="rosybrown1")) +
ggnewscale::new_scale_fill() +
geom_point(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Worst_MR_BLUP_cat), colour=Worst_MR_BLUP_cat, fill=Worst_MR_BLUP_cat), alpha=0.2) +
geom_line(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=UID, colour=Worst_MR_BLUP_cat), stat="smooth", method='lm', linewidth=0.5, se=F, alpha=0.1) +
stat_smooth(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Worst_MR_BLUP_cat), colour=Worst_MR_BLUP_cat, fill=Worst_MR_BLUP_cat), method='lm', linewidth=0.5, se=T, alpha=0.1) +
scale_colour_manual(values = color_map,limits = score_levels, drop = FALSE) +
scale_fill_manual(values = color_map, limits = score_levels,drop = FALSE) +
labs(colour="Myrtle rust category", x="Date", title = "Height by myrtle rust worst category across time") +
guides(fill='none') +
geom_vline(data=planting_dates, aes(xintercept=Date), colour='grey70', linetype="dashed", linewidth=0.5) +
facet_wrap(~Site)
plot_dates_height_worst
## Regular monitoring
score_levels <- c("No infection", "Low", "Mid", "High")
colors <- colorRampPalette(c( "forestgreen", "red"))(length(score_levels))
color_map <- setNames(colors, score_levels)
plot_dates_height_worst <- ggplot() +
geom_rect(data = season_rects, aes(xmin = as.numeric(season_start), xmax = as.numeric(season_end),  ymin = -Inf, ymax = Inf,  fill = Season), alpha = 0.1, inherit.aes = FALSE) +
scale_fill_manual(values = c("Autumn" = "goldenrod1", "Winter" = "skyblue", "Spring"="palegreen2", Summer="rosybrown1")) +
ggnewscale::new_scale_fill() +
geom_point(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Worst_MR_BLUP_cat), colour=Worst_MR_BLUP_cat, fill=Worst_MR_BLUP_cat), alpha=0.2) +
geom_line(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=UID, colour=Worst_MR_BLUP_cat), stat="smooth", method='lm', linewidth=0.5, se=F, alpha=0.1) +
stat_smooth(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Worst_MR_BLUP_cat), colour=Worst_MR_BLUP_cat, fill=Worst_MR_BLUP_cat), method='lm', linewidth=0.5, se=T, alpha=0.1) +
scale_colour_manual(values = color_map,limits = score_levels, drop = FALSE) +
scale_fill_manual(values = color_map, limits = score_levels,drop = FALSE) +
labs(colour="Myrtle rust category", x="Date", title = "Height by myrtle rust worst category across time") +
guides(fill='none') +
geom_vline(data=planting_dates, aes(xintercept=Date), colour='grey70', linetype="dashed", linewidth=0.5) +
facet_wrap(~Site)
plot_dates_height_impact <- ggplot() +
geom_rect(data = season_rects, aes(xmin = as.numeric(season_start), xmax = as.numeric(season_end),  ymin = -Inf, ymax = Inf,  fill = Season), alpha = 0.1, inherit.aes = FALSE) +
scale_fill_manual(values = c("Autumn" = "goldenrod1", "Winter" = "skyblue", "Spring"="palegreen2", Summer="rosybrown1")) +
ggnewscale::new_scale_fill() +
geom_point(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Impact_MR_BLUP_cat), colour=Impact_MR_BLUP_cat, fill=Impact_MR_BLUP_cat), alpha=0.2) +
geom_line(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=UID, colour=Impact_MR_BLUP_cat), stat="smooth", method='lm', linewidth=0.5, se=F, alpha=0.1) +
stat_smooth(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Impact_MR_BLUP_cat), colour=Impact_MR_BLUP_cat, fill=Impact_MR_BLUP_cat), method='lm', linewidth=0.5, se=T, alpha=0.1) +
scale_colour_manual(values = color_map,limits = score_levels, drop = FALSE) +
scale_fill_manual(values = color_map, limits = score_levels,drop = FALSE) +
labs(colour="Myrtle rust category", x="Date", title = "Height by myrtle rust impact category across time") +
guides(fill='none') +
geom_vline(data=planting_dates, aes(xintercept=Date), colour='grey70', linetype="dashed", linewidth=0.5) +
facet_wrap(~Site)
## Binary
plot_dates_height_binary <- ggplot() +
geom_rect(data = season_rects, aes(xmin = as.numeric(season_start), xmax = as.numeric(season_end),  ymin = -Inf, ymax = Inf,  fill = Season), alpha = 0.1, inherit.aes = FALSE) +
scale_fill_manual(values = c("Autumn" = "goldenrod1", "Winter" = "skyblue", "Spring"="palegreen2", Summer="rosybrown1")) +
ggnewscale::new_scale_fill() +
geom_point(data=bin_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(BS_MR_BLUP_cat), colour=BS_MR_BLUP_cat, fill=BS_MR_BLUP_cat), alpha=0.2) +
geom_line(data=bin_rm_snapped, aes(x=Date, y=`Height (m)`, group=UID, colour=BS_MR_BLUP_cat), stat="smooth", method='lm', linewidth=0.5, se=F, alpha=0.1) +
stat_smooth(data=bin_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(BS_MR_BLUP_cat), colour=BS_MR_BLUP_cat, fill=BS_MR_BLUP_cat), method='lm', linewidth=0.5, se=T, alpha=0.1) +
scale_colour_manual(values = color_map,limits = score_levels, drop = FALSE) +
scale_fill_manual(values = color_map, limits = score_levels,drop = FALSE) +
labs(colour="Myrtle rust category", x="Date", title = "Height by myrtle rust binary category across time") +
guides(fill='none') +
geom_vline(data=planting_dates, aes(xintercept=Date), colour='grey70', linetype="dashed", linewidth=0.5) +
facet_wrap(~Site)
plot_both <- plot_dates_height_worst/plot_dates_height_impact/plot_dates_height_binary + plot_layout(guides = "collect", axes = "collect")
ggsave(plot_both, file="~/Uni/Doctorate/Ch Planting/Publication/Plots/plot_dates_height.jpg", width=4000, height=3000, units="px", limitsize=F)
plot_dates_height_worst <- ggplot() +
geom_rect(data = season_rects, aes(xmin = as.numeric(season_start), xmax = as.numeric(season_end),  ymin = -Inf, ymax = Inf,  fill = Season), alpha = 0.1, inherit.aes = FALSE) +
scale_fill_manual(values = c("Autumn" = "goldenrod1", "Winter" = "skyblue", "Spring"="palegreen2", Summer="rosybrown1")) +
ggnewscale::new_scale_fill() +
geom_point(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Worst_MR_BLUP_cat), colour=Worst_MR_BLUP_cat, fill=Worst_MR_BLUP_cat), alpha=0.2) +
geom_line(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=UID, colour=Worst_MR_BLUP_cat), stat="smooth", method='lm', linewidth=0.5, se=F, alpha=0.1) +
stat_smooth(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Worst_MR_BLUP_cat), colour=Worst_MR_BLUP_cat, fill=Worst_MR_BLUP_cat), method='lm', linewidth=0.5, se=T, alpha=0.1) +
scale_colour_manual(values = color_map,limits = score_levels, drop = FALSE) +
scale_fill_manual(values = color_map, limits = score_levels,drop = FALSE) +
labs(colour="Myrtle rust BLUP category", x="Date", title = "Height by myrtle rust worst category across time") +
theme(legend.position="none") +
geom_vline(data=planting_dates, aes(xintercept=Date), colour='grey70', linetype="dashed", linewidth=0.5) +
facet_wrap(~Site)
plot_dates_height_impact <- ggplot() +
geom_rect(data = season_rects, aes(xmin = as.numeric(season_start), xmax = as.numeric(season_end),  ymin = -Inf, ymax = Inf,  fill = Season), alpha = 0.1, inherit.aes = FALSE) +
scale_fill_manual(values = c("Autumn" = "goldenrod1", "Winter" = "skyblue", "Spring"="palegreen2", Summer="rosybrown1")) +
ggnewscale::new_scale_fill() +
geom_point(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Impact_MR_BLUP_cat), colour=Impact_MR_BLUP_cat, fill=Impact_MR_BLUP_cat), alpha=0.2) +
geom_line(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=UID, colour=Impact_MR_BLUP_cat), stat="smooth", method='lm', linewidth=0.5, se=F, alpha=0.1) +
stat_smooth(data=reg_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(Impact_MR_BLUP_cat), colour=Impact_MR_BLUP_cat, fill=Impact_MR_BLUP_cat), method='lm', linewidth=0.5, se=T, alpha=0.1) +
scale_colour_manual(values = color_map,limits = score_levels, drop = FALSE) +
scale_fill_manual(values = color_map, limits = score_levels,drop = FALSE) +
labs(colour="Myrtle rust BLUP category", x="Date", title = "Height by myrtle rust impact category across time") +
theme(legend.position="none") +
geom_vline(data=planting_dates, aes(xintercept=Date), colour='grey70', linetype="dashed", linewidth=0.5) +
facet_wrap(~Site)
## Binary
plot_dates_height_binary <- ggplot() +
geom_rect(data = season_rects, aes(xmin = as.numeric(season_start), xmax = as.numeric(season_end),  ymin = -Inf, ymax = Inf,  fill = Season), alpha = 0.1, inherit.aes = FALSE) +
scale_fill_manual(values = c("Autumn" = "goldenrod1", "Winter" = "skyblue", "Spring"="palegreen2", Summer="rosybrown1")) +
ggnewscale::new_scale_fill() +
geom_point(data=bin_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(BS_MR_BLUP_cat), colour=BS_MR_BLUP_cat, fill=BS_MR_BLUP_cat), alpha=0.2) +
geom_line(data=bin_rm_snapped, aes(x=Date, y=`Height (m)`, group=UID, colour=BS_MR_BLUP_cat), stat="smooth", method='lm', linewidth=0.5, se=F, alpha=0.1) +
stat_smooth(data=bin_rm_snapped, aes(x=Date, y=`Height (m)`, group=as.factor(BS_MR_BLUP_cat), colour=BS_MR_BLUP_cat, fill=BS_MR_BLUP_cat), method='lm', linewidth=0.5, se=T, alpha=0.1) +
scale_colour_manual(values = color_map,limits = score_levels, drop = FALSE) +
scale_fill_manual(values = color_map, limits = score_levels,drop = FALSE) +
labs(colour="Myrtle rust BLUP category", x="Date", title = "Height by myrtle rust binary category across time") +
guides(fill='none') +
geom_vline(data=planting_dates, aes(xintercept=Date), colour='grey70', linetype="dashed", linewidth=0.5) +
facet_wrap(~Site)
plot_both <- plot_dates_height_worst/plot_dates_height_impact/plot_dates_height_binary + plot_layout(guides = "collect", axes = "collect")
ggsave(plot_both, file="~/Uni/Doctorate/Ch Planting/Publication/Plots/plot_dates_height.jpg", width=4000, height=3000, units="px", limitsize=F)
View(reg_rm_snapped)
unique(reg_rm_snapped$Worst_MR_BLUP_cat)
plot_overall_climate
coeff=0.05
Station_data_filt <- Station_data %>% filter(Month_num >= min(as.numeric(month (reg_monit_survey_results$Date))) )
plot_overall_climate
# Set up
## Metadata
metadata <- read_xlsx("~/Uni/Doctorate/Samples/All_samples.xlsx")
# Site data
site_metadata <- metadata %>% group_by(Site) %>% filter(!is.na(Latitude)) %>% summarise(mean_lat = mean(Latitude), mean_long = mean(Longitude))
## Monthly average data
# worldclim_country("Australia", var="tmin", path="~/Delete", res=0.5)
# worldclim_country("Australia", var="tmax", path="~/Delete", res=0.5)
# worldclim_country("Australia", var="prec", path="~/Delete", res=0.5)
# worldclim_country("Australia", var="wind", path="~/Delete", res=0.5)
mnth_avg_prec <- raster("~/Uni/Doctorate/Ch Planting/data/AUS_wc2.1_30s_prec.tif")
mnth_avg_tmax <- raster("~/Uni/Doctorate/Ch Planting/data/AUS_wc2.1_30s_tmax.tif")
mnth_avg_tmin <- raster("~/Uni/Doctorate/Ch Planting/data/AUS_wc2.1_30s_tmin.tif")
mnth_avg_wndspd <- raster("~/Uni/Doctorate/Ch Planting/data/AUS_wc2.1_30s_wind.tif")
#
# ## Station data
#https://www.bom.gov.au/nsw/observations/nswall.shtml
clim_res=NULL
for (i in 1:nrow(site_metadata)){
site=site_metadata[i, "Site"]
lat=as.numeric(site_metadata[i, "mean_lat"]); long=as.numeric(site_metadata[i, "mean_long"])
prec = raster::extract(mnth_avg_prec, cbind(long, lat))
tmax = raster::extract(mnth_avg_tmax, cbind(long, lat))
wndspd = raster::extract(mnth_avg_wndspd, cbind(long, lat))
tmin = raster::extract(mnth_avg_tmin, cbind(long, lat))
clim_res <- as.data.frame(rbind(clim_res, cbind(Site=site$Site, prec=prec, tmax=tmax, wndspd=wndspd, tmin=tmin)))
}
remove(mnth_avg_prec); remove(mnth_avg_tmax); remove(mnth_avg_tmin); remove(mnth_avg_wndspd)
clim_res$Site <- gsub("HunterWetlandCentre", "HWC", clim_res$Site)
reg_monit_survey_results_mat_GT_summ_clim <- left_join(reg_monit_survey_results_mat_GT_summ, clim_res)
bin_monit_survey_results_mat_GT_summ_clim <- left_join(bin_monit_survey_results_mat_GT_summ, clim_res)
## Regular monitoring - impact
Impact_prec_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Impact_MR_BLUP_rescale_difference, x=prec, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
scale_y_continuous(limits = c(-1,3)) +
labs(x="Precipitation (mm) at 30s") +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1")  +
labs(y = "Difference Observed Score against Myrtle Rust Impact")
Impact_maxtmp_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Impact_MR_BLUP_rescale_difference, x=tmax, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Maximum temperature at 30s") +
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x))) +
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1") +
theme(axis.title.y = element_blank(),
axis.text.y  = element_blank())
Impact_mintmp_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Impact_MR_BLUP_rescale_difference, x=tmin, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Minimum temperature at 30s") +
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x))) +
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1") +
labs(y = "Difference Observed Score against Myrtle Rust Impact")
Impact_windpsd_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Impact_MR_BLUP_rescale_difference, x=wndspd, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Windspeed at 30s")+
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x)))+
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1")  +
theme(axis.title.y = element_blank(),
axis.text.y  = element_blank())
left_col  <- (Impact_prec_avg_plot / Impact_mintmp_avg_plot) +
plot_layout(axes = "collect_y")
right_col <- (Impact_windpsd_avg_plot / Impact_maxtmp_avg_plot) +
plot_layout(axes = "collect_y")
impact_climate_avg_plot <- (left_col | right_col) +
plot_layout(guides = "collect")
ggsave(impact_climate_avg_plot, file="~/Uni/Doctorate/Ch Planting/Publication/Plots/reg_impact_clim_avg.jpg", width=2500, height=2000, units="px", limitsize=F)
######## Regular monitoing worst
Worst_prec_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Worst_MR_BLUP_rescale_difference, x=prec, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
scale_y_continuous(limits = c(-1,3)) +
labs(x="Precipitation (mm) at 30s") +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1")  +
labs(y = "Difference Observed Score against Myrtle Rust Worst")
Worst_maxtmp_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Worst_MR_BLUP_rescale_difference, x=tmax, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Maximum temperature at 30s") +
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x))) +
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1") +
theme(axis.title.y = element_blank(),
axis.text.y  = element_blank())
Worst_mintmp_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Worst_MR_BLUP_rescale_difference, x=tmin, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Minimum temperature at 30s") +
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x))) +
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1") +
labs(y = "Difference Observed Score against Myrtle Rust Worst")
Worst_windpsd_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Worst_MR_BLUP_rescale_difference, x=wndspd, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Windspeed at 30s")+
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x)))+
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1")  +
theme(axis.title.y = element_blank(),
axis.text.y  = element_blank())
left_col  <- (Worst_prec_avg_plot / Worst_mintmp_avg_plot) +
plot_layout(axes = "collect_y")
right_col <- (Worst_windpsd_avg_plot / Worst_maxtmp_avg_plot) +
plot_layout(axes = "collect_y")
Worst_climate_avg_plot <- (left_col | right_col) +
plot_layout(guides = "collect")
ggsave(Worst_climate_avg_plot, file="~/Uni/Doctorate/Ch Planting/Publication/Plots/reg_worst_clim_avg.jpg", width=2500, height=2000, units="px", limitsize=F)
######## Binary monitoring
BS_prec_avg_plot <- ggplot(bin_monit_survey_results_mat_GT_summ_clim, aes(y=BS_MR_BLUP_rescale_difference, x=prec, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
scale_y_continuous(limits = c(-1,3)) +
labs(x="Precipitation (mm) at 30s") +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1")  +
labs(y = "Difference Observed Score against Myrtle Rust BS")
BS_maxtmp_avg_plot <- ggplot(bin_monit_survey_results_mat_GT_summ_clim, aes(y=BS_MR_BLUP_rescale_difference, x=tmax, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Maximum temperature at 30s") +
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x))) +
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1") +
theme(axis.title.y = element_blank(),
axis.text.y  = element_blank())
BS_mintmp_avg_plot <- ggplot(bin_monit_survey_results_mat_GT_summ_clim, aes(y=BS_MR_BLUP_rescale_difference, x=tmin, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Minimum temperature at 30s") +
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x))) +
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1") +
labs(y = "Difference Observed Score against Myrtle Rust BS")
BS_windpsd_avg_plot <- ggplot(bin_monit_survey_results_mat_GT_summ_clim, aes(y=BS_MR_BLUP_rescale_difference, x=wndspd, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Windspeed at 30s")+
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x)))+
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1")  +
theme(axis.title.y = element_blank(),
axis.text.y  = element_blank())
left_col  <- (BS_prec_avg_plot / BS_mintmp_avg_plot) +
plot_layout(axes = "collect_y")
right_col <- (BS_windpsd_avg_plot / BS_maxtmp_avg_plot) +
plot_layout(axes = "collect_y")
BS_climate_avg_plot <- (left_col | right_col) +
plot_layout(guides = "collect")
ggsave(BS_climate_avg_plot, file="~/Uni/Doctorate/Ch Planting/Publication/Plots/reg_BS_clim_avg.jpg", width=2500, height=2000, units="px", limitsize=F)
plot_all_clim_avg <- Worst_climate_avg_plot / impact_climate_avg_plot / BS_climate_avg_plot + plot_layout(guides = "collect")
plot_all_clim_avg
## Regular monitoring - impact
Impact_prec_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Impact_MR_BLUP_rescale_difference, x=prec, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
scale_y_continuous(limits = c(-1,3)) +
labs(x="Precipitation (mm) at 30s") +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1")  +
labs(y = "Difference Observed Score against Myrtle Rust Impact")
Impact_maxtmp_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Impact_MR_BLUP_rescale_difference, x=tmax, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Maximum temperature at 30s") +
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x))) +
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1") +
theme(axis.title.y = element_blank(),
axis.text.y  = element_blank())
Impact_mintmp_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Impact_MR_BLUP_rescale_difference, x=tmin, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Minimum temperature at 30s") +
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x))) +
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1") +
labs(y = "Difference Observed Score against Myrtle Rust Impact")
Impact_windpsd_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Impact_MR_BLUP_rescale_difference, x=wndspd, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Windspeed at 30s")+
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x)))+
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1")  +
theme(axis.title.y = element_blank(),
axis.text.y  = element_blank())
left_col  <- (Impact_prec_avg_plot / Impact_mintmp_avg_plot) +
plot_layout(axes = "collect_y")
right_col <- (Impact_windpsd_avg_plot / Impact_maxtmp_avg_plot) +
plot_layout(axes = "collect_y")
impact_climate_avg_plot <- (left_col | right_col) +
plot_layout(guides = "collect")
ggsave(impact_climate_avg_plot, file="~/Uni/Doctorate/Ch Planting/Publication/Plots/clim_avg_reg_impact.jpg", width=2500, height=2000, units="px", limitsize=F)
######## Regular monitoing worst
Worst_prec_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Worst_MR_BLUP_rescale_difference, x=prec, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
scale_y_continuous(limits = c(-1,3)) +
labs(x="Precipitation (mm) at 30s") +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1")  +
labs(y = "Difference Observed Score against Myrtle Rust Worst")
Worst_maxtmp_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Worst_MR_BLUP_rescale_difference, x=tmax, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Maximum temperature at 30s") +
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x))) +
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1") +
theme(axis.title.y = element_blank(),
axis.text.y  = element_blank())
Worst_mintmp_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Worst_MR_BLUP_rescale_difference, x=tmin, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Minimum temperature at 30s") +
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x))) +
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1") +
labs(y = "Difference Observed Score against Myrtle Rust Worst")
Worst_windpsd_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Worst_MR_BLUP_rescale_difference, x=wndspd, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Windspeed at 30s")+
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x)))+
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1")  +
theme(axis.title.y = element_blank(),
axis.text.y  = element_blank())
left_col  <- (Worst_prec_avg_plot / Worst_mintmp_avg_plot) +
plot_layout(axes = "collect_y")
right_col <- (Worst_windpsd_avg_plot / Worst_maxtmp_avg_plot) +
plot_layout(axes = "collect_y")
Worst_climate_avg_plot <- (left_col | right_col) +
plot_layout(guides = "collect")
ggsave(Worst_climate_avg_plot, file="~/Uni/Doctorate/Ch Planting/Publication/Plots/clim_avg_reg_worst.jpg", width=2500, height=2000, units="px", limitsize=F)
######## Binary monitoring
BS_prec_avg_plot <- ggplot(bin_monit_survey_results_mat_GT_summ_clim, aes(y=BS_MR_BLUP_rescale_difference, x=prec, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
scale_y_continuous(limits = c(-1,3)) +
labs(x="Precipitation (mm) at 30s") +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1")  +
labs(y = "Difference Observed Score against Myrtle Rust BS")
BS_maxtmp_avg_plot <- ggplot(bin_monit_survey_results_mat_GT_summ_clim, aes(y=BS_MR_BLUP_rescale_difference, x=tmax, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Maximum temperature at 30s") +
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x))) +
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1") +
theme(axis.title.y = element_blank(),
axis.text.y  = element_blank())
BS_mintmp_avg_plot <- ggplot(bin_monit_survey_results_mat_GT_summ_clim, aes(y=BS_MR_BLUP_rescale_difference, x=tmin, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Minimum temperature at 30s") +
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x))) +
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1") +
labs(y = "Difference Observed Score against Myrtle Rust BS")
BS_windpsd_avg_plot <- ggplot(bin_monit_survey_results_mat_GT_summ_clim, aes(y=BS_MR_BLUP_rescale_difference, x=wndspd, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Windspeed at 30s")+
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x)))+
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1")  +
theme(axis.title.y = element_blank(),
axis.text.y  = element_blank())
left_col  <- (BS_prec_avg_plot / BS_mintmp_avg_plot) +
plot_layout(axes = "collect_y")
right_col <- (BS_windpsd_avg_plot / BS_maxtmp_avg_plot) +
plot_layout(axes = "collect_y")
BS_climate_avg_plot <- (left_col | right_col) +
plot_layout(guides = "collect")
ggsave(BS_climate_avg_plot, file="~/Uni/Doctorate/Ch Planting/Publication/Plots/clim_avg_BS.jpg", width=2500, height=2000, units="px", limitsize=F)
plot_all_clim_avg <- Worst_climate_avg_plot / impact_climate_avg_plot / BS_climate_avg_plot + plot_layout(guides = "collect")
plot_all_clim_avg
plot_all_clim_avg <- Worst_climate_avg_plot $ theme(legend.position = "none") / impact_climate_avg_plot / BS_climate_avg_plot + plot_layout(guides = "collect")
Worst_climate_avg_plot&  theme(legend.position = "none")
plot_all_clim_avg <- (Worst_climate_avg_plot / impact_climate_avg_plot / BS_climate_avg_plot) + plot_layout(guides = "collect")
plot_all_clim_avg
plot_all_clim_avg <- (Worst_climate_avg_plot&  theme(legend.position = "none") / impact_climate_avg_plot / BS_climate_avg_plot&  theme(legend.position = "none")) + plot_layout(guides = "collect")
plot_all_clim_avg <- (Worst_climate_avg_plot&  theme(legend.position = "none")) / impact_climate_avg_plot / (BS_climate_avg_plot &  theme(legend.position = "none"))
plot_all_clim_avg
ggsave(plot_all_clim_avg, file="~/Uni/Doctorate/Ch Planting/Publication/Plots/clim_avg_all.jpg", width=2500, height=5500, units="px", limitsize=F)
reg_monit_survey_results_mat_GT_summ_clim$Site <- as.factor(reg_monit_survey_results_mat_GT_summ_clim$Site)
## Regular monitoring - impact
Impact_prec_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Impact_MR_BLUP_rescale_difference, x=prec, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
scale_y_continuous(limits = c(-1,3)) +
labs(x="Precipitation (mm) at 30s") +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1")  +
labs(y = "Difference Observed Score against Myrtle Rust Impact")
Impact_maxtmp_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Impact_MR_BLUP_rescale_difference, x=tmax, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Maximum temperature at 30s") +
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x))) +
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1") +
theme(axis.title.y = element_blank(),
axis.text.y  = element_blank())
Impact_mintmp_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Impact_MR_BLUP_rescale_difference, x=tmin, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Minimum temperature at 30s") +
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x))) +
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1") +
labs(y = "Difference Observed Score against Myrtle Rust Impact")
Impact_windpsd_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Impact_MR_BLUP_rescale_difference, x=wndspd, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Windspeed at 30s")+
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x)))+
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1")  +
theme(axis.title.y = element_blank(),
axis.text.y  = element_blank())
left_col  <- (Impact_prec_avg_plot / Impact_mintmp_avg_plot) +
plot_layout(axes = "collect_y")
left_col
reg_monit_survey_results_mat_GT_summ_clim$Site <- factor(reg_monit_survey_results_mat_GT_summ_clim$Site, levels = c("Cattai", "HWC", "Cold Tea Creek_LMC"))
## Regular monitoring - impact
Impact_prec_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Impact_MR_BLUP_rescale_difference, x=prec, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
scale_y_continuous(limits = c(-1,3)) +
labs(x="Precipitation (mm) at 30s") +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1")  +
labs(y = "Difference Observed Score against Myrtle Rust Impact")
Impact_maxtmp_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Impact_MR_BLUP_rescale_difference, x=tmax, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Maximum temperature at 30s") +
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x))) +
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1") +
theme(axis.title.y = element_blank(),
axis.text.y  = element_blank())
Impact_mintmp_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Impact_MR_BLUP_rescale_difference, x=tmin, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Minimum temperature at 30s") +
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x))) +
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1") +
labs(y = "Difference Observed Score against Myrtle Rust Impact")
Impact_windpsd_avg_plot <- ggplot(reg_monit_survey_results_mat_GT_summ_clim, aes(y=Impact_MR_BLUP_rescale_difference, x=wndspd, colour=Site, fill = Site)) +
geom_boxplot(alpha=0.3) +
labs(x="Windspeed at 30s")+
scale_x_discrete(labels = function(x) sprintf("%.2f", as.numeric(x)))+
scale_y_continuous(limits = c(-1,3)) +
scale_fill_discrete(palette = "Set1") + scale_colour_discrete(palette = "Set1")  +
theme(axis.title.y = element_blank(),
axis.text.y  = element_blank())
left_col  <- (Impact_prec_avg_plot / Impact_mintmp_avg_plot) +
plot_layout(axes = "collect_y")
left_col
Impact_prec_avg_plot
Impact_maxtmp_avg_plot
Impact_mintmp_avg_plot
