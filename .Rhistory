ages=50
for (MR in c(0.2, 0.4, 0.6, 0.8, 1.0)){
MR_chance <- numeric(length(MR))
if(!(MR_age_impact_val==0)){
MR_chance <- (1 / (1 + (ages / MR_age_impact_val))) * MR * MR_death_impact_val
} else {
MR_chance <- MR * MR_death_impact_val
}
MR_chance[MR_chance > 1] <- 1; MR_chance[MR_chance < 0] <- 0 # remove anomaly high and low vals
MR_mortality_chance_all <- data.frame(rbind(MR_mortality_chance_all , cbind(MR_chance=MR_chance, MR_impact_value=MR_death_impact_val)))
}
}
# Initialize storage
MR_mortality_chance_all <- data.frame(MR_chance=numeric(),
MR_impact_value=numeric(),
MR=numeric(),
ages=numeric())
# Example: define MR_age_impact_val if not already defined
# MR_age_impact_val <- 10
for (MR_death_impact_val in c(0.2, 0.4, 0.6, 0.8, 1.0)) {
ages <- 50
for (MR in c(0.2, 0.4, 0.6, 0.8, 1.0)) {
# Compute MR_chance
if (MR_age_impact_val != 0) {
MR_chance <- (1 / (1 + (ages / MR_age_impact_val))) * MR * MR_death_impact_val
} else {
MR_chance <- MR * MR_death_impact_val
}
# Clamp values to [0,1]
MR_chance <- max(0, min(1, MR_chance))
# Append to results
MR_mortality_chance_all <- rbind(
MR_mortality_chance_all,
data.frame(MR_chance=MR_chance,
MR_impact_value=MR_death_impact_val,
MR=MR,
ages=ages)
)
}
}
View(MR_mortality_chance_all)
View(MR_mortality_chance_all)
age_mortality_chance_all_0.8 <- age_mortality_chance_all %>% filter(age_impact_value == 0.8) %>% dplyr::select(-c(age_impact_value))
for (ages in seq(1:200)){
for(age_impact_value in c(0.2, 0.4, 0.6, 0.8, 1.0)) {
age_mortality_chance <- numeric(length(ages))
for (i in seq_along(ages)) {
x <- ages[i]
if (x <= mortality_age_shiftch/2) {
age_mortality_chance[i] <- young_mortality(x, age_impact_value, mortality_age_shiftch)
} else {
age_mortality_chance[i] <- mature_mortality(x, age_impact_value, mortality_age_shiftch)
}
}
age_mortality_chance[age_mortality_chance > 1] <- 1 # remove anomaly high and low vals
age_mortality_chance[age_mortality_chance < 0] <- 0 # remove anomaly high and low vals
age_mortality_chance_all <- data.frame(rbind(age_mortality_chance_all , cbind(age_mortality_chance=age_mortality_chance, age_impact_value=age_impact_value)))
}
}
age_mortality_chance_all=null\
for (ages in seq(1:200)){
for(age_impact_value in c(0.2, 0.4, 0.6, 0.8, 1.0)) {
age_mortality_chance <- numeric(length(ages))
for (i in seq_along(ages)) {
x <- ages[i]
if (x <= mortality_age_shiftch/2) {
age_mortality_chance[i] <- young_mortality(x, age_impact_value, mortality_age_shiftch)
} else {
age_mortality_chance[i] <- mature_mortality(x, age_impact_value, mortality_age_shiftch)
}
}
age_mortality_chance[age_mortality_chance > 1] <- 1 # remove anomaly high and low vals
age_mortality_chance[age_mortality_chance < 0] <- 0 # remove anomaly high and low vals
age_mortality_chance_all <- data.frame(rbind(age_mortality_chance_all , cbind(age_mortality_chance=age_mortality_chance, age_impact_value=age_impact_value)))
}
}
MR_mortality_chance_all = NULL
age_mortality_chance_all=NULL
# Initialize as empty data.frames
MR_mortality_chance_all <- data.frame(MR_chance=numeric(),
MR_impact_value=numeric(),
MR=numeric())
age_mortality_chance_all <- data.frame(age_mortality_chance=numeric(),
age_impact_value=numeric(),
age=numeric())
# Outer loop
for (MR_death_impact_val in c(0.2, 0.4, 0.6, 0.8, 1.0)) {
# ----- MR mortality chance -----
ages_fixed <- 50  # assume fixed for this loop
for (MR in seq(from=0, to=1, by=0.05)) {
if (MR_age_impact_val != 0) {
MR_chance <- (1 / (1 + (ages_fixed / MR_age_impact_val))) * MR * MR_death_impact_val
} else {
MR_chance <- MR * MR_death_impact_val
}
# Append
MR_mortality_chance_all <- rbind(
MR_mortality_chance_all,
data.frame(MR_chance=MR_chance,
MR_impact_value=MR_death_impact_val,
MR=MR)
)
}
# ----- Age mortality chance -----
for (age in 1:200) {
for (age_impact_value in c(0.2, 0.4, 0.6, 0.8, 1.0)) {
if (age <= mortality_age_shiftch/2) {
chance <- young_mortality(age, age_impact_value, mortality_age_shiftch)
} else {
chance <- mature_mortality(age, age_impact_value, mortality_age_shiftch)
}
# clamp to [0,1]
chance <- max(0, min(1, chance))
# Append
age_mortality_chance_all <- rbind(
age_mortality_chance_all,
data.frame(age_mortality_chance=chance,
age_impact_value=age_impact_value,
age=age)
)
}
}
}
total_mortality_chance_both <- data.frame(cbind(MR_mortality_chance_all, age_mortality_chance_all_0.8)) %>%
mutate(final_mortality_chance_norm=MR_chance + age_mortality_chance - (MR_chance*age_mortality_chance))
View(MR_mortality_chance_all)
MR_mortality_chance_all = NULL
age_mortality_chance_all=NULL
# Initialize as empty data.frames
MR_mortality_chance_all <- data.frame(MR_chance=numeric(),
MR_impact_value=numeric(),
MR=numeric())
age_mortality_chance_all <- data.frame(age_mortality_chance=numeric(),
age_impact_value=numeric(),
age=numeric())
# Outer loop
for (MR_death_impact_val in c(0.2, 0.4, 0.6, 0.8, 1.0)) {
for (age in 1:200) {
for (age_impact_value in c(0.2, 0.4, 0.6, 0.8, 1.0)) {
if (age <= mortality_age_shiftch/2) {
chance <- young_mortality(age, age_impact_value, mortality_age_shiftch)
} else {
chance <- mature_mortality(age, age_impact_value, mortality_age_shiftch)
}
# clamp to [0,1]
chance <- max(0, min(1, chance))
# Append
age_mortality_chance_all <- rbind(
age_mortality_chance_all,
data.frame(age_mortality_chance=chance,
age_impact_value=age_impact_value,
age=age)
)
for (MR in seq(from=0, to=1, by=0.05)) {
if (MR_age_impact_val != 0) {
MR_chance <- (1 / (1 + (age / MR_age_impact_val))) * MR * MR_death_impact_val
} else {
MR_chance <- MR * MR_death_impact_val
}
# Append
MR_mortality_chance_all <- rbind(
MR_mortality_chance_all,
data.frame(MR_chance=MR_chance,
MR_impact_value=MR_death_impact_val,
MR=MR)
)
}
}
}
}
for (MR_death_impact_val in c(0.2, 0.4, 0.6, 0.8, 1.0)) {
for (age in 1:200) {
for (age_impact_value in c(0.2, 0.4, 0.6, 0.8, 1.0)) {
# Compute age mortality
if (age <= mortality_age_shiftch/2) {
age_chance <- young_mortality(age, age_impact_value, mortality_age_shiftch)
} else {
age_chance <- mature_mortality(age, age_impact_value, mortality_age_shiftch)
}
age_chance <- max(0, min(1, age_chance))  # clamp
for (MR in seq(0, 1, 0.05)) {
# Compute MR chance
if (MR_age_impact_val != 0) {
MR_chance <- (1 / (1 + (age / MR_age_impact_val))) * MR * MR_death_impact_val
} else {
MR_chance <- MR * MR_death_impact_val
}
MR_chance <- max(0, min(1, MR_chance))  # clamp
# Append one row to master dataset
results_all <- rbind(
results_all,
data.frame(
MR_death_impact_val = MR_death_impact_val,
age = age,
age_impact_value = age_impact_value,
MR = MR,
age_mortality_chance = age_chance,
MR_chance = MR_chance
)
)
}
}
}
}
# Initialize as empty data.frames
results_all <- data.frame(
MR_death_impact_val = numeric(),
age = numeric(),
age_impact_value = numeric(),
MR = numeric(),
age_mortality_chance = numeric(),
MR_chance = numeric()
)
for (MR_death_impact_val in c(0.2, 0.4, 0.6, 0.8, 1.0)) {
for (age in 1:200) {
for (age_impact_value in c(0.2, 0.4, 0.6, 0.8, 1.0)) {
# Compute age mortality
if (age <= mortality_age_shiftch/2) {
age_chance <- young_mortality(age, age_impact_value, mortality_age_shiftch)
} else {
age_chance <- mature_mortality(age, age_impact_value, mortality_age_shiftch)
}
age_chance <- max(0, min(1, age_chance))  # clamp
for (MR in seq(0, 1, 0.05)) {
# Compute MR chance
if (MR_age_impact_val != 0) {
MR_chance <- (1 / (1 + (age / MR_age_impact_val))) * MR * MR_death_impact_val
} else {
MR_chance <- MR * MR_death_impact_val
}
MR_chance <- max(0, min(1, MR_chance))  # clamp
# Append one row to master dataset
results_all <- rbind(
results_all,
data.frame(
MR_death_impact_val = MR_death_impact_val,
age = age,
age_impact_value = age_impact_value,
MR = MR,
age_mortality_chance = age_chance,
MR_chance = MR_chance
)
)
}
}
}
}
for (MR_death_impact_val in c(0.3, 0.9) {
for (MR_death_impact_val in c(0.3, 0.9)) {
for (age in 1:200) {
for (age_impact_value in c(0.3, 0.9)) {
# Compute age mortality
if (age <= mortality_age_shiftch/2) {
age_chance <- young_mortality(age, age_impact_value, mortality_age_shiftch)
} else {
age_chance <- mature_mortality(age, age_impact_value, mortality_age_shiftch)
}
age_chance <- max(0, min(1, age_chance))  # clamp
for (MR in seq(0, 1, 0.05)) {
# Compute MR chance
if (MR_age_impact_val != 0) {
MR_chance <- (1 / (1 + (age / MR_age_impact_val))) * MR * MR_death_impact_val
} else {
MR_chance <- MR * MR_death_impact_val
}
MR_chance <- max(0, min(1, MR_chance))  # clamp
# Append one row to master dataset
results_all <- rbind(
results_all,
data.frame(
MR_death_impact_val = MR_death_impact_val,
age = age,
age_impact_value = age_impact_value,
MR = MR,
age_mortality_chance = age_chance,
MR_chance = MR_chance
)
)
}
}
}
}
for (MR_death_impact_val in c(0.3, 0.9)) {
for (age in seq(0, 200, 5) {
for (age in seq(0, 200, 5)) {
for (age_impact_value in c(0.3, 0.9)) {
# Compute age mortality
if (age <= mortality_age_shiftch/2) {
age_chance <- young_mortality(age, age_impact_value, mortality_age_shiftch)
} else {
age_chance <- mature_mortality(age, age_impact_value, mortality_age_shiftch)
}
age_chance <- max(0, min(1, age_chance))  # clamp
for (MR in seq(0, 1, 0.1)) {
# Compute MR chance
if (MR_age_impact_val != 0) {
MR_chance <- (1 / (1 + (age / MR_age_impact_val))) * MR * MR_death_impact_val
} else {
MR_chance <- MR * MR_death_impact_val
}
MR_chance <- max(0, min(1, MR_chance))  # clamp
# Append one row to master dataset
results_all <- rbind(
results_all,
data.frame(
MR_death_impact_val = MR_death_impact_val,
age = age,
age_impact_value = age_impact_value,
MR = MR,
age_mortality_chance = age_chance,
MR_chance = MR_chance
)
)
}
}
}
library(breepr)
install.packages("breepr")
install.packages("beepr")
beep()
beepr::beep()
beepr::beep()
beepr::beep()
beepr::beep(sound = 4)
beepr::beep(sound = 8)
beepr::beep(sound = 2
)
beepr::beep(sound = 3)
beepr::beep(sound = 5)
beepr::beep(sound = 6)
beepr::beep(sound = 6)
beepr::beep(sound = 7)
beepr::beep(sound = 8)
beepr::beep(sound = 9)
beepr::beep(sound = 9)
beepr::beep(sound = 10)
beepr::beep(sound = 11)
beepr::beep(sound = 12)
beepr::beep(sound = 13)
View(results_all)
results_all <- results_all %>%
mutate(final_mortality_chance_norm=MR_chance + age_mortality_chance - (MR_chance*age_mortality_chance))
ggplot() +
geom_point(data=total_mortality_chance_both, aes(x=ages, y=final_mortality_chance_norm, colour=as.character(MR))) +
theme_bw() +
facet_wrap(~age_impact_val*MR_impact_value) +
labs(y="MR imparted mortality chance", x="Myrtle rust", colour="MR impact value")
View(total_mortality_chance_both)
View(results_all)
ggplot() +
geom_point(data=results_all, aes(x=ages, y=final_mortality_chance_norm, colour=as.character(MR))) +
theme_bw() +
facet_wrap(~age_impact_val*MR_impact_value) +
labs(y="MR imparted mortality chance", x="Myrtle rust", colour="MR impact value")
View(results_all)
View(results_all)
View(results_all)
View(results_all)
View(results_all)
View(results_all)
ggplot() +
geom_point(data=results_all, aes(x=ages, y=final_mortality_chance_norm, colour=as.character(MR))) +
theme_bw() +
facet_wrap(~age_impact_val*MR_death_impact_value) +
labs(y="MR imparted mortality chance", x="Myrtle rust", colour="MR impact value")
ggplot() +
geom_point(data=results_all, aes(x=ages, y=final_mortality_chance_norm, colour=as.character(MR))) +
theme_bw() +
facet_wrap(~(age_impact_val*MR_death_impact_value)) +
labs(y="MR imparted mortality chance", x="Myrtle rust", colour="MR impact value")
ggplot() +
geom_point(data=results_all, aes(x=ages, y=final_mortality_chance_norm, colour=as.character(MR))) +
theme_bw()
View(results_all)
ggplot() +
geom_point(data=results_all, aes(x=age, y=final_mortality_chance_norm, colour=as.character(MR))) +
theme_bw() +
facet_wrap(~(age_impact_val*MR_death_impact_value)) +
labs(y="MR imparted mortality chance", x="Myrtle rust", colour="MR impact value")
head(results_all)
ggplot() +
geom_point(data=results_all, aes(x=age, y=final_mortality_chance_norm, colour=as.character(MR))) +
theme_bw() +
facet_wrap(~(age_impact_val*MR_death_impact_val)) +
labs(y="MR imparted mortality chance", x="Myrtle rust", colour="MR impact value")
ggplot() +
geom_point(data=results_all, aes(x=age, y=final_mortality_chance_norm, colour=as.character(MR))) +
theme_bw() +
facet_wrap(~(age_impact_val+MR_death_impact_val)) +
labs(y="MR imparted mortality chance", x="Myrtle rust", colour="MR impact value")
ggplot() +
geom_point(data=results_all, aes(x=age, y=final_mortality_chance_norm, colour=as.character(MR))) +
theme_bw() +
facet_wrap(~(as.character(age_impact_val) + as.character(MR_death_impact_val))) +
labs(y="MR imparted mortality chance", x="Myrtle rust", colour="MR impact value")
ggplot() +
geom_point(data=results_all, aes(x=age, y=final_mortality_chance_norm, colour=as.character(MR))) +
theme_bw() +
facet_wrap(~as.character(age_impact_val) + as.character(MR_death_impact_val)) +
labs(y="MR imparted mortality chance", x="Myrtle rust", colour="MR impact value")
ggplot() +
geom_line(data=results_all, aes(x=age, y=final_mortality_chance_norm, colour=as.character(MR))) +
theme_bw() +
facet_wrap(~as.character(age_impact_val) + as.character(MR_death_impact_val)) +
labs(y="MR imparted mortality chance", x="Myrtle rust", colour="MR impact value")
ggplot() +
geom_line(data=results_all, aes(x=age, y=final_mortality_chance_norm, group=as.character, colour=(MR))) +
theme_bw() +
facet_wrap(~as.character(age_impact_val) + as.character(MR_death_impact_val)) +
labs(y="MR imparted mortality chance", x="Myrtle rust", colour="MR impact value")
ggplot() +
geom_line(data=results_all, aes(x=age, y=final_mortality_chance_norm, group=MR, colour=(MR))) +
theme_bw() +
facet_wrap(~as.character(age_impact_val) + as.character(MR_death_impact_val)) +
labs(y="MR imparted mortality chance", x="Myrtle rust", colour="MR impact value")
View(results_all)
results_all$MR <- factor(results_all$MR)   # make MR discrete
ggplot(results_all, aes(x=age, y=final_mortality_chance_norm,
group=MR, colour=MR)) +
geom_line() +
theme_bw() +
facet_wrap(~ age_impact_value + MR_death_impact_val, labeller = label_both) +
labs(
y = "MR imparted mortality chance",
x = "Age",
colour = "MR"
)
age_impact_value
for (MR_death_impact_val in c(0.3, 0.9)) {
for (age in seq(0, 200, 10)) {
for (age_impact_value in c(0.3, 0.9)) {
# Compute age mortality
if (age <= mortality_age_shiftch/2) {
age_chance <- young_mortality(age, age_impact_value, mortality_age_shiftch)
} else {
age_chance <- mature_mortality(age, age_impact_value, mortality_age_shiftch)
}
age_chance <- max(0, min(1, age_chance))  # clamp
for (MR in seq(0, 1, 0.1)) {
# Compute MR chance
if (MR_age_impact_val != 0) {
MR_chance <- (1 / (1 + (age / MR_age_impact_val))) * MR * MR_death_impact_val
} else {
MR_chance <- MR * MR_death_impact_val
}
MR_chance <- max(0, min(1, MR_chance))  # clamp
# Append one row to master dataset
results_all <- rbind(
results_all,
data.frame(
MR_death_impact_val = MR_death_impact_val,
age = age,
age_impact_value = age_impact_value,
MR = MR,
age_mortality_chance = age_chance,
MR_chance = MR_chance
)
)
}
}
}
}
results_all <- data.frame(
MR_death_impact_val = numeric(),
age = numeric(),
age_impact_value = numeric(),
MR = numeric(),
age_mortality_chance = numeric(),
MR_chance = numeric()
)
for (MR_death_impact_val in c(0.3, 0.9)) {
for (age in seq(0, 200, 10)) {
for (age_impact_value in c(0.3, 0.9)) {
# Compute age mortality
if (age <= mortality_age_shiftch/2) {
age_chance <- young_mortality(age, age_impact_value, mortality_age_shiftch)
} else {
age_chance <- mature_mortality(age, age_impact_value, mortality_age_shiftch)
}
age_chance <- max(0, min(1, age_chance))  # clamp
for (MR in seq(0, 1, 0.1)) {
# Compute MR chance
if (MR_age_impact_val != 0) {
MR_chance <- (1 / (1 + (age / MR_age_impact_val))) * MR * MR_death_impact_val
} else {
MR_chance <- MR * MR_death_impact_val
}
MR_chance <- max(0, min(1, MR_chance))  # clamp
# Append one row to master dataset
results_all <- rbind(
results_all,
data.frame(
MR_death_impact_val = MR_death_impact_val,
age = age,
age_impact_value = age_impact_value,
MR = MR,
age_mortality_chance = age_chance,
MR_chance = MR_chance
)
)
}
}
}
}
results_all <- results_all %>%
mutate(final_mortality_chance_norm=MR_chance + age_mortality_chance - (MR_chance*age_mortality_chance))
results_all$MR <- factor(results_all$MR)   # make MR discrete
ggplot(results_all, aes(x=age, y=final_mortality_chance_norm, group=MR, colour=MR)) +
geom_line() +
theme_bw() +
facet_wrap(~ age_impact_value + MR_death_impact_val, labeller = label_both) +
labs(y = "MR imparted mortality chance", x = "Age", colour = "MR")
